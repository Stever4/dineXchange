{% include 'header.html' %}
<script type = 'text/javascript'>
window.onload = getOffer();
var otherSent = false;

function sendOffer(){
    console.log("Hello");
    var money = document.getElementById('offer').value;
    if(!isNaN(money)){
        var myRootRef = new Firebase('https://dxc.firebaseio.com/sell/test');
        myRootRef.child('offer').set(money);
        document.getElementById('agreeButton').innerHTML = "Waiting for agreement...";
        otherSent = false;
    }
    document.getElementById('offer').value = "";

}

function getOffer(){
    var otherRootRef = new Firebase('https://dxc.firebaseio.com/sell/test');
    otherRootRef.on('value', function(snapshot){
            if(snapshot.val() != null){
                var money = snapshot.val()['offer'];
                console.log("Initial offer"+money);
                document.getElementById('otherOffer').innerHTML = "Other offer:$ "+money;
                document.getElementById("agreeButton").innerHTML = "Agree";
                otherSent = true;
        }
    })
}

function agree(){
    if(otherSent){
        console.log('Agreement Reached!');
    }

}

</script>

<div style="text-align: center;">
    <div>
        <label>My Offer: $</label>
        <input type="text" id="offer"/>
        <a class = "btn btn-lg btn-primary" onclick="return sendOffer()">Send offer</a>
    </div>
    <label id="otherOffer">Other offer:$</label>
    <a class = "btn btn-lg btn-primary" onclick="return agree()" id = "agreeButton">Waiting for agreement...</a>
</div>
{% include 'footer.html' %}