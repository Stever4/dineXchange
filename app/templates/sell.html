{% include 'header.html' %}
<div style="text-align: center;" class="row">
	<h1 id="location"></h1>

<div id = "food" class="row">
<a class="btn btn-xlg btn-primary" onclick='return checkIn()'>Check In</a>
</div>

<script type='text/javascript'>
	window.onload = waitForMatch();
	function checkIn()
	{
	var el = document.getElementById('dropdown');
    var location = el.options[el.selectedIndex].innerHTML;
    var myRootRef = new Firebase('https://dxc.firebaseio.com/sell/' + '{{user}}');
	myRootRef.child('location').set(location);
	myRootRef.child('time').set(new Date().getTime());
	document.getElementById("location").innerHTML = "Currently @ " + location;
	}

	function checkOut()
	{
	var el = document.getElementById('dropdown');
    var location = el.options[el.selectedIndex].innerHTML;
	var myRootRef = new Firebase('https://dxc.firebaseio.com/sell/' + '{{user}}');
	myRootRef.child('location').set(null);
	myRootRef.child('time').set(null);
	myRootRef.child('room').set(null);
	document.getElementById("location").innerHTML = "";
	}
	function waitForMatch()
	{
		var otherRootRef = new Firebase('https://dxc.firebaseio.com/sell/'+ '{{user}}/room');
    	otherRootRef.on('value', function(snapshot)
    	{
    		if (snapshot.val() != null){
    			var room = snapshot.val();
    			checkOut();
                window.location = "/bargain?room="+room;
            }
    	})
	}
</script>



<div id = "food" class="row">
<select class="form-control" id="dropdown">
  <option>Entropy</option>
  <option>Skibo</option>
  <option>Resnik</option>
  <option>Asiana</option>
  <option>The Exchange</option>
</select>
</div>

<div id = "food" class="row">
<a class="btn btn-xlg btn-primary" onclick='return checkOut()'>Check Out</a>
</div>
</div>
{% include 'footer.html' %}
